<!doctype html>
<html lang="en-GB"><head><meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">

	<link rel="icon" type="image/png" href="../favicon.png">

	<title>Array modification | Docs | Ractive.js</title>

	
	<link href="http://fonts.googleapis.com/css?family=Source+Code+Pro:400,700,900" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="../min.css"></head>

<body class="example"><header class="docs-header"><nav><a href="http://ractivejs.org">&laquo; back to ractivejs.org</a>
			<a class="edit-link" href="https://github.com/RactiveJS/docs.ractivejs.org/edit/master/docs/0.3.9/Array modification.md"><span>edit this page</span></a></nav>

		<h1>Array modification</h1></header>

	<main><div class="breadcrumbs"><a href="ractive-js-documentation">Home</a> &raquo; <a href="glossary">Glossary</a> &raquo; <a href="array-modification">Array modification</a></div>

<p>By default, Ractive will intercept the <em>mutator methods</em> (<code>pop</code>, <code>push</code>, <code>shift</code>, <code>unshift</code>, <code>splice</code>, <code>sort</code> and <code>reverse</code>) of arrays that it <a href="dependants">depends on</a> for more convenient data binding.</p>
<p>Consider the following:</p>
<pre class="prettyprint lang-html">&lt;ul&gt;
  {{#list}}
    &lt;li&gt;{{.}}&lt;/li&gt;
  {{/list}}
&lt;/ul&gt;</pre>

<pre class="prettyprint lang-js">list = [ 'a', 'b', 'c' ];

ractive = new Ractive({
  el: myContainer,
  template: myTemplate,
  data: { list: list }
});

list.push( 'd' ); // adds a new list item &ndash; &lt;li&gt;d&lt;/li&gt;</pre>

<p>You can disable this behaviour by passing in <code>modifyArrays: false</code> as an <a href="Initialisation options">initialisation option</a>.</p>
<h2 id="how-it-works">How it works</h2>
<p>Don&#39;t worry, we&#39;re not modifying <code>Array.prototype</code>. (What do you think this is, <a href="http://emberjs.com/guides/configuring-ember/disabling-prototype-extensions/">Ember</a>? :-)</p>
<p>Instead, we&#39;re using a technique called <a href="http://perfectionkills.com/how-ecmascript-5-still-does-not-allow-to-subclass-an-array/#wrappers_prototype_chain_injection">prototype chain injection</a>, which allows us to remain performant and memory-efficient without mucking about extending native objects.</p>
<p>This uses the non-standard (but very unlikely to disappear!) <code>__proto__</code> property. That might seem kludgy, but if <a href="http://bost.ocks.org/mike/selection/#subclass">Mike Bostock thinks it&#39;s okay</a> then that&#39;s good enough for us.</p>
<p>Older browsers (I&#39;m looking at you, IE8) don&#39;t support <code>__proto__</code> &ndash; in these cases, we simply add the wrapped methods as properties of the array itself.</p>
<p>As well as intercepting or wrapping the mutator methods, Ractive adds a (non-enumerable, in modern browsers) <code>_ractive</code> property to arrays, which contains information about which Ractive instances depend on the array, and which keypaths it is assigned to.</p>
<h2 id="hygiene">Hygiene</h2>
<p>When an array is no longer depended on by any Ractive instances, we can revert it to its normal state &ndash; resetting its prototype (if we used prototype chain injection) or deleting the wrapped methods (if we&#39;re in a crap browser), and removing the <code>_ractive</code> property.</p>
<h2 id="performance-and-ui-benefits">Performance and UI benefits</h2>
<p>As well as convenience, using arrays like this helps Ractive make smart decisions about how to update the DOM. Continuing the example above, compare these two alternative methods of inserting a new item at the <em>start</em> of our list:</p>
<pre class="prettyprint lang-js">// at the moment, list = [ 'a', 'b', 'c', 'd' ]

// 1. Reset the list:
ractive.set( 'list', [ 'z', 'a', 'b', 'c', 'd' ] )

// 2. Use `unshift`:
list.unshift( 'z' );</pre>

<p>In the first example, Ractive will see that the content of the first list item has changed from <code>&#39;a&#39;</code> to <code>&#39;z&#39;</code>, and that the second has changed from <code>&#39;b&#39;</code> to <code>&#39;a&#39;</code>, and so on, and update the DOM accordingly. It will also see that there is now a fifth item, so will append <code>&lt;li&gt;d&lt;/li&gt;</code> to the list.</p>
<p>In the second example, Ractive will understand that all it needs to do is insert <code>&lt;li&gt;z&lt;/li&gt;</code> at the start of the list, leaving everything else untouched.</p>
<p>This is particularly important if you&#39;re using <a href="transitions">transitions</a>, as it will be obvious to the user which elements are being added and removed.</p>
<p>Note that if <code>list.unshift(&#39;z&#39;)</code> isn&#39;t an option, you could use <a href="ractive-merge">ractive.merge()</a> to achieve the same effect.</p>
</main>

	
	<script src="../js/prettify.js"></script>
	<script>prettyPrint();

		// Googlytics
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-5602942-6', 'ractivejs.org');
		ga('send', 'pageview');</script></body></html>